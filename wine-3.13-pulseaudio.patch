From f0d3ae8cf201128497ddb5c3d89e1c8778726ac2 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Tue, 24 Jul 2018 11:32:12 +1000
Subject: [PATCH] Updated winepulse-PulseAudio_Support patchset

Fixes: https://bugs.winehq.org/show_bug.cgi?id=45502
---
 .../0002-winepulse-Don-t-rely-on-pulseaudio-callbacks-for-tim.patch | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/patches/winepulse-PulseAudio_Support/0002-winepulse-Don-t-rely-on-pulseaudio-callbacks-for-tim.patch b/patches/winepulse-PulseAudio_Support/0002-winepulse-Don-t-rely-on-pulseaudio-callbacks-for-tim.patch
index a483298e..7ff59b0e 100644
--- a/patches/winepulse-PulseAudio_Support/0002-winepulse-Don-t-rely-on-pulseaudio-callbacks-for-tim.patch
+++ b/patches/winepulse-PulseAudio_Support/0002-winepulse-Don-t-rely-on-pulseaudio-callbacks-for-tim.patch
@@ -1,4 +1,4 @@
-From 6b24328a061f853e5aafe258fc8f3075aae71b16 Mon Sep 17 00:00:00 2001
+From 4611d3dd983d7707d845508ddde2d49e9daafec5 Mon Sep 17 00:00:00 2001
 From: Andrew Eikum <aeikum@codeweavers.com>
 Date: Fri, 1 Jun 2018 14:43:01 -0500
 Subject: [PATCH 2/7] winepulse: Don't rely on pulseaudio callbacks for timing
@@ -8,7 +8,7 @@ Subject: [PATCH 2/7] winepulse: Don't rely on pulseaudio callbacks for timing
  1 file changed, 231 insertions(+), 274 deletions(-)
 
 diff --git a/dlls/winepulse.drv/mmdevdrv.c b/dlls/winepulse.drv/mmdevdrv.c
-index f192b1d..0654ab0 100644
+index f192b1d..b750986 100644
 --- a/dlls/winepulse.drv/mmdevdrv.c
 +++ b/dlls/winepulse.drv/mmdevdrv.c
 @@ -169,13 +169,16 @@ struct ACImpl {
@@ -198,7 +198,7 @@ index f192b1d..0654ab0 100644
                      This->peek_len = 0;
 -            } else {
 -                pa_stream_peek(This->stream, (const void**)&src, &src_len);
-+            } else if (pa_stream_peek(This->stream, (const void**)&src, &src_len) && src_len) {
++            } else if (pa_stream_peek(This->stream, (const void**)&src, &src_len) == 0 && src_len) {
  
                  copy = min(rem, src_len);
  
