--- a/dlls/crypt32/crypt32_private.h	2020-01-21 11:03:21.000000000 -0600
+++ b/dlls/crypt32/crypt32_private.h	2020-01-22 09:09:42.545954092 -0600
@@ -152,7 +152,7 @@
  */
 HCRYPTPROV WINAPI I_CryptGetDefaultCryptProv(ALG_ID);
 
-HINSTANCE hInstance DECLSPEC_HIDDEN;
+extern HINSTANCE hInstance DECLSPEC_HIDDEN;
 
 void crypt_oid_init(void) DECLSPEC_HIDDEN;
 void crypt_oid_free(void) DECLSPEC_HIDDEN;
--- a/dlls/gphoto2.ds/gphoto2_i.h	2020-01-21 11:03:21.000000000 -0600
+++ b/dlls/gphoto2.ds/gphoto2_i.h	2020-01-22 10:07:59.403974843 -0600
@@ -100,7 +100,7 @@
     struct jpeg_decompress_struct	jd;
     struct jpeg_error_mgr		jerr;
 #endif
-} activeDS DECLSPEC_HIDDEN;
+} extern activeDS DECLSPEC_HIDDEN;
 
 /* Helper functions */
 extern TW_UINT16 GPHOTO2_SaneCapability (pTW_CAPABILITY pCapability, TW_UINT16 action) DECLSPEC_HIDDEN;
--- a/dlls/gphoto2.ds/gphoto2_main.c	2020-01-22 10:22:39.110786117 -0600
+++ b/dlls/gphoto2.ds/gphoto2_main.c	2020-01-22 10:22:51.743818190 -0600
@@ -33,6 +33,8 @@
 
 WINE_DEFAULT_DEBUG_CHANNEL(twain);
 
+struct tagActiveDS activeDS;
+
 DSMENTRYPROC GPHOTO2_dsmentry;
 
 #ifdef HAVE_GPHOTO2
--- a/dlls/secur32/secur32_priv.h	2020-01-21 11:03:21.000000000 -0600
+++ b/dlls/secur32/secur32_priv.h	2020-01-22 10:31:24.606451345 -0600
@@ -190,8 +190,8 @@
 #define NTLMSSP_NEGOTIATE_56                        0x80000000
 
 
-SecPkgInfoW *ntlm_package_infoW DECLSPEC_HIDDEN;
-SecPkgInfoA *ntlm_package_infoA DECLSPEC_HIDDEN;
+extern SecPkgInfoW *ntlm_package_infoW DECLSPEC_HIDDEN;
+extern SecPkgInfoA *ntlm_package_infoA DECLSPEC_HIDDEN;
 
 /* schannel internal interface */
 typedef struct schan_imp_session_opaque *schan_imp_session;
--- a/dlls/sane.ds/sane_i.h	2020-01-21 11:03:21.000000000 -0600
+++ b/dlls/sane.ds/sane_i.h	2020-01-22 10:44:01.675004730 -0600
@@ -36,7 +36,7 @@
 #include "twain.h"
 
 #ifdef SONAME_LIBSANE
-#define MAKE_FUNCPTR(f) typeof(f) * p##f DECLSPEC_HIDDEN;
+#define MAKE_FUNCPTR(f) extern typeof(f) * p##f DECLSPEC_HIDDEN;
 MAKE_FUNCPTR(sane_init)
 MAKE_FUNCPTR(sane_exit)
 MAKE_FUNCPTR(sane_get_devices)
@@ -84,7 +84,7 @@
     TW_FIX32            defaultXResolution;
     BOOL                YResolutionSet;
     TW_FIX32            defaultYResolution;
-} activeDS DECLSPEC_HIDDEN;
+} extern activeDS DECLSPEC_HIDDEN;
 
 /* Helper functions */
 extern TW_UINT16 SANE_SaneCapability (pTW_CAPABILITY pCapability, TW_UINT16 action) DECLSPEC_HIDDEN;
--- a/dlls/sane.ds/sane_main.c	2020-01-22 10:45:52.264351469 -0600
+++ b/dlls/sane.ds/sane_main.c	2020-01-22 10:46:12.131414210 -0600
@@ -33,8 +33,25 @@
 DSMENTRYPROC SANE_dsmentry;
 
 #ifdef SONAME_LIBSANE
+#define MAKE_FUNCPTR(f) typeof(f) * p##f;
+MAKE_FUNCPTR(sane_init)
+MAKE_FUNCPTR(sane_exit)
+MAKE_FUNCPTR(sane_get_devices)
+MAKE_FUNCPTR(sane_open)
+MAKE_FUNCPTR(sane_close)
+MAKE_FUNCPTR(sane_get_option_descriptor)
+MAKE_FUNCPTR(sane_control_option)
+MAKE_FUNCPTR(sane_get_parameters)
+MAKE_FUNCPTR(sane_start)
+MAKE_FUNCPTR(sane_read)
+MAKE_FUNCPTR(sane_cancel)
+MAKE_FUNCPTR(sane_set_io_mode)
+MAKE_FUNCPTR(sane_get_select_fd)
+MAKE_FUNCPTR(sane_strstatus)
+#undef MAKE_FUNCPTR
 
 HINSTANCE SANE_instance;
+struct tagActiveDS activeDS;
 
 static void *libsane_handle;
 
--- a/dlls/winebus.sys/bus.h	2020-01-21 11:03:21.000000000 -0600
+++ b/dlls/winebus.sys/bus.h	2020-01-22 13:35:57.841283330 -0600
@@ -54,5 +54,5 @@
 DWORD check_bus_option(const UNICODE_STRING *option, DWORD default_value) DECLSPEC_HIDDEN;
 BOOL is_xbox_gamepad(WORD vid, WORD pid) DECLSPEC_HIDDEN;
 
-HANDLE driver_key DECLSPEC_HIDDEN;
-DEVICE_OBJECT *bus_pdo DECLSPEC_HIDDEN;
+extern HANDLE driver_key DECLSPEC_HIDDEN;
+extern DEVICE_OBJECT *bus_pdo DECLSPEC_HIDDEN;
--- a/dlls/dsound/dsound_private.h	2020-01-21 11:03:21.000000000 -0600
+++ b/dlls/dsound/dsound_private.h	2020-01-22 13:56:10.367702536 -0600
@@ -188,9 +188,9 @@
     IDirectSoundBufferImpl **ppdsb,
     IDirectSoundBufferImpl *pdsb) DECLSPEC_HIDDEN;
 void secondarybuffer_destroy(IDirectSoundBufferImpl *This) DECLSPEC_HIDDEN;
-const IDirectSound3DListenerVtbl ds3dlvt DECLSPEC_HIDDEN;
-const IDirectSound3DBufferVtbl ds3dbvt DECLSPEC_HIDDEN;
-const IKsPropertySetVtbl iksbvt DECLSPEC_HIDDEN;
+extern const IDirectSound3DListenerVtbl ds3dlvt DECLSPEC_HIDDEN;
+extern const IDirectSound3DBufferVtbl ds3dbvt DECLSPEC_HIDDEN;
+extern const IKsPropertySetVtbl iksbvt DECLSPEC_HIDDEN;
 
 HRESULT IKsPrivatePropertySetImpl_Create(REFIID riid, void **ppv) DECLSPEC_HIDDEN;
 
--- a/dlls/mshtml/mshtml_private.h	2020-01-21 11:03:21.000000000 -0600
+++ b/dlls/mshtml/mshtml_private.h	2020-01-22 14:44:00.789960837 -0600
@@ -355,12 +355,12 @@
 
 DEFINE_GUID(IID_nsXPCOMCycleCollectionParticipant, 0x9674489b,0x1f6f,0x4550,0xa7,0x30, 0xcc,0xae,0xdd,0x10,0x4c,0xf9);
 
-nsrefcnt (__cdecl *ccref_incr)(nsCycleCollectingAutoRefCnt*,nsISupports*) DECLSPEC_HIDDEN;
-nsrefcnt (__cdecl *ccref_decr)(nsCycleCollectingAutoRefCnt*,nsISupports*,ExternalCycleCollectionParticipant*) DECLSPEC_HIDDEN;
-void (__cdecl *ccref_init)(nsCycleCollectingAutoRefCnt*,nsrefcnt) DECLSPEC_HIDDEN;
-void (__cdecl *ccp_init)(ExternalCycleCollectionParticipant*,const CCObjCallback*) DECLSPEC_HIDDEN;
-void (__cdecl *describe_cc_node)(nsCycleCollectingAutoRefCnt*,const char*,nsCycleCollectionTraversalCallback*) DECLSPEC_HIDDEN;
-void (__cdecl *note_cc_edge)(nsISupports*,const char*,nsCycleCollectionTraversalCallback*) DECLSPEC_HIDDEN;
+extern nsrefcnt (__cdecl *ccref_incr)(nsCycleCollectingAutoRefCnt*,nsISupports*) DECLSPEC_HIDDEN;
+extern nsrefcnt (__cdecl *ccref_decr)(nsCycleCollectingAutoRefCnt*,nsISupports*,ExternalCycleCollectionParticipant*) DECLSPEC_HIDDEN;
+extern void (__cdecl *ccref_init)(nsCycleCollectingAutoRefCnt*,nsrefcnt) DECLSPEC_HIDDEN;
+extern void (__cdecl *ccp_init)(ExternalCycleCollectionParticipant*,const CCObjCallback*) DECLSPEC_HIDDEN;
+extern void (__cdecl *describe_cc_node)(nsCycleCollectingAutoRefCnt*,const char*,nsCycleCollectionTraversalCallback*) DECLSPEC_HIDDEN;
+extern void (__cdecl *note_cc_edge)(nsISupports*,const char*,nsCycleCollectionTraversalCallback*) DECLSPEC_HIDDEN;
 
 void init_dispex_with_compat_mode(DispatchEx*,IUnknown*,dispex_static_data_t*,compat_mode_t) DECLSPEC_HIDDEN;
 void release_dispex(DispatchEx*) DECLSPEC_HIDDEN;
--- a/dlls/mshtml/htmlstyle.h	2020-01-22 14:45:04.824112648 -0600
+++ b/dlls/mshtml/htmlstyle.h	2020-01-21 11:03:21.000000000 -0600
@@ -142,7 +142,7 @@
                     dispex_static_data_t*,compat_mode_t) DECLSPEC_HIDDEN;
 
 void CSSStyle_init_dispex_info(dispex_data_t *info, compat_mode_t mode) DECLSPEC_HIDDEN;
-const dispex_static_data_vtbl_t CSSStyle_dispex_vtbl DECLSPEC_HIDDEN;
+extern const dispex_static_data_vtbl_t CSSStyle_dispex_vtbl DECLSPEC_HIDDEN;
 
 HRESULT get_style_property(CSSStyle*,styleid_t,BSTR*) DECLSPEC_HIDDEN;
 HRESULT get_style_property_var(CSSStyle*,styleid_t,VARIANT*) DECLSPEC_HIDDEN;
--- a/dlls/mshtml/main.c	2020-01-22 15:13:00.207929201 -0600
+++ b/dlls/mshtml/main.c	2020-01-22 15:13:10.037943213 -0600
@@ -51,6 +51,12 @@
 HINSTANCE hInst;
 DWORD mshtml_tls = TLS_OUT_OF_INDEXES;
 
+void (__cdecl *ccp_init)(ExternalCycleCollectionParticipant*,const CCObjCallback*);
+nsrefcnt (__cdecl *ccref_decr)(nsCycleCollectingAutoRefCnt*,nsISupports*,ExternalCycleCollectionParticipant*);
+nsrefcnt (__cdecl *ccref_incr)(nsCycleCollectingAutoRefCnt*,nsISupports*);
+void (__cdecl *describe_cc_node)(nsCycleCollectingAutoRefCnt*,const char*,nsCycleCollectionTraversalCallback*);
+void (__cdecl *note_cc_edge)(nsISupports*,const char*,nsCycleCollectionTraversalCallback*);
+
 static HINSTANCE shdoclc = NULL;
 static WCHAR *status_strings[IDS_STATUS_LAST-IDS_STATUS_FIRST+1];
 static IMultiLanguage2 *mlang;
